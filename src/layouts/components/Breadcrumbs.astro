---
import { humanize } from "@/lib/utils/textConverter";

const { className }: { className?: string } = Astro.props;

const paths = Astro.url.pathname.split("/").filter((x) => x);
const labelOverrides: Record<string, string> = {
  projects: "โปรเจกต์ของฉัน",
  blog: "บล็อก",
  about: "เกี่ยวกับ",
  contact: "ติดต่อ",
};

let parts = [
  {
    label: "หน้าแรก",
    href: "/",
    "aria-label": Astro.url.pathname === "/" ? "page" : undefined,
  },
];

paths.forEach((label: string, i: number) => {
  const href = `/${paths.slice(0, i + 1).join("/")}`;
  const rawLabel = label.replace(".html", "").replace(/[-_]/g, " ");
  const displayLabel = labelOverrides[label] || humanize(rawLabel) || "";
  label !== "page" &&
    parts.push({
      label: displayLabel,
      href,
      "aria-label": Astro.url.pathname === href ? "page" : undefined,
    });
});
---

<nav
  aria-label="Breadcrumb"
  class={className}
>
  <ol
    class="inline-flex"
    role="list"
  >
    {
      parts.map(({ label, ...attrs }, index) => (
        <li
          class="mx-1 capitalize"
          role="listitem"
        >
          {index > 0 && <span class="inlin-block mr-1">/</span>}
          {index !== parts.length - 1 ? (
            <a
              class="text-primary dark:text-darkmode-primary"
              {...attrs}
            >
              {label}
            </a>
          ) : (
            <span class="text-text-light dark:text-darkmode-text-light">
              {label}
            </span>
          )}
        </li>
      ))
    }
  </ol>
</nav>
